---
import MainLayout from '../../layouts/MainLayout.astro';
import PhotoGrid from '../../components/PhotoGrid.astro';
import { getCollections, getImages } from '../../data/imageStore';

const allCollection = {
	id: undefined,
	name: 'Todo',
};
const collections = [allCollection, ...(await getCollections())];
const { collection } = Astro.params;
const images = await getImages(collection ? { collection } : {});

export const getStaticPaths = async () => {
	return [{ id: undefined }, ...(await getCollections())].map((collection) => {
		return {
			params: { collection: collection.id },
		};
	});
};
---

<MainLayout>
	<section class="py-20 pt-28">
		<div class="container-custom">
			<div class="section-shell p-8 md:p-10">
				<div class="mb-10 text-center space-y-4">
					<span class="badge-soft">Colecciones</span>
					<h1 class="text-4xl md:text-5xl font-semibold title-gradient">Galería</h1>
					<p class="text-lg text-[hsl(215,18%,32%)] max-w-2xl mx-auto">
						Explora series fotográficas seleccionadas: retratos intimistas, paisajes cálidos y escenas editoriales con foco en la luz.
					</p>
				</div>

				<div class="flex justify-center mb-8">
					<div class="flex flex-wrap gap-2 justify-center">
						{
							collections.map((collectionBtn) => (
								<a href={`/collections/${collectionBtn.id ? collectionBtn.id : ''}`}>
									<div
										class={`button-ghost ${
											collectionBtn.id === collection
												? 'border-[hsla(31,66%,60%,0.35)] bg-[hsla(31,66%,60%,0.12)] text-[hsl(220,33%,12%)]'
												: ''
										}`}
									>
										{collectionBtn.name}
									</div>
								</a>
							))
						}
					</div>
				</div>

				<PhotoGrid images={images} />
			</div>
		</div>
	</section>
</MainLayout>
